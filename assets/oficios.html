<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b111b" />
  <title>Empleos en Comunidad - Oficios</title>
  <meta name="description" content="Empleos en Comunidad - Cat√°logo comunitario de oficios con contacto directo por WhatsApp." />
  <link rel="manifest" href="manifest.webmanifest" crossorigin="use-credentials" />
  <link rel="icon" type="image/svg+xml" sizes="192x192" href="../icons/icon-192.svg" />
  <link rel="icon" type="image/svg+xml" sizes="512x512" href="../icons/icon-512.svg" />
  <link rel="apple-touch-icon" href="../icons/icon-192.svg" />
  <link rel="stylesheet" href="styles.base.css" />
  <link rel="stylesheet" href="styles.layout.css" />
  <link rel="stylesheet" href="styles.components.css" />
  <link rel="stylesheet" href="styles.css" />

  <!-- PocketBase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/pocketbase@0.21.0/dist/pocketbase.umd.js"></script>
</head>

<body>
  <main class="container">
    <a href="../index.html" class="back-link">‚Üê Volver al inicio</a>
    <h1><a href="../index.html" class="page-title-link">Empleos en Comunidad</a></h1>

    <section class="toolbar">
      <input id="q" placeholder="Buscar por nombre u oficio" />
      <select id="selOficio">
        <option value="">Todos los oficios</option>
      </select>
      <select id="selUbicacion">
        <option value="">Todas las ubicaciones</option>
      </select>
      <button id="btnReset" class="secondary">Limpiar</button>

      <button id="btnSoyProfesional" class="primary">üîé Tengo un oficio</button>

      <div id="userMenu" class="user-menu">
        <button id="btnUserMenu" type="button" class="user-menu-button" aria-label="Men√∫ de usuario">
          <span id="userMenuIcon" class="user-menu-icon">Men√∫</span>
        </button>
        <div id="userMenuDropdown" class="user-menu-dropdown">
          <button type="button" id="btnLoginCuenta">Iniciar sesi√≥n</button>
          <button type="button" id="btnRegistroCuenta">Crear cuenta</button>
          <button type="button" id="btnMiPerfil">Mi perfil</button>
          <button type="button" id="btnCambiarVista">Ver ofertas</button>
          <button type="button" id="btnLogout">Cerrar sesi√≥n</button>
        </div>
      </div>
    </section>

    <div class="stats-container hidden">
      <div id="filtrosAplicados" class="filtros-aplicados"></div>
      <div class="stats-row">
        <div class="stat-item">
          <span class="stat-label">Total de oficios publicados:</span>
          <span class="stat-value" id="statTotal">0</span>
        </div>
        <div class="stat-item hidden">
          <span class="stat-label">Contactos registrados:</span>
          <span class="stat-value stat-prestado" id="statPrestados">0</span>
        </div>
      </div>
    </div>

    <section id="tabla" class="card"></section>

    <!-- Modal de Perfil de Oficio -->
    <dialog id="dlg">
      <form method="dialog" id="frmPerfil">
        <div class="dialog-header">
          <h3 id="dlgTitle">Perfil de oficio</h3>
          <div id="perfilFechaPublicacion" class="perfil-fecha-publicacion"></div>
          <button type="button" id="btnCerrarDialogTop" class="dialog-close-mobile" aria-label="Cerrar perfil">
            ‚úï
          </button>
        </div>
        <div id="mensajeCargaMovil" class="mensaje-carga-movil"></div>
        <div class="dialog-container perfil-container">
          <div class="perfil-main">
            <div class="perfil-header">
              <div id="perfilFoto" class="perfil-foto"></div>
              <div class="perfil-info">
                <h2 id="perfilNombre"></h2>
                <p class="perfil-oficio" id="perfilOficio"></p>
                <div class="perfil-rating" id="perfilRating"></div>
                <div id="perfilBadge" class="perfil-badge"></div>
              </div>
            </div>

            <div class="perfil-section">
              <h4>üìç Ubicaci√≥n y Modalidad</h4>
              <div class="perfil-grid">
                <div>
                  <strong>Ubicaci√≥n:</strong> <span id="perfilUbicacion"></span>
                </div>
                <div>
                  <strong>Modalidad:</strong> <span id="perfilModalidad"></span>
                </div>
                <div>
                  <strong>Contactos:</strong> <span id="perfilContactos"></span>
                </div>
              </div>
            </div>

            <div class="perfil-section">
              <h4>üíº Experiencia</h4>
              <p id="perfilExperiencia"></p>
            </div>

            <div class="perfil-section">
              <h4>üõ†Ô∏è Habilidades</h4>
              <div id="perfilHabilidades" class="habilidades-list"></div>
            </div>

            <div class="perfil-section">
              <h4>üîó Portafolio</h4>
              <div id="perfilPortafolio"></div>
            </div>

            <div class="perfil-section">
              <h4>‚≠ê Calificaciones Recientes</h4>
              <div id="calificacionesRecientes"></div>
            </div>
          </div>
        </div>

        <div class="dialog-footer perfil-footer">
          <div class="dialog-footer-row">
            <button type="button" id="btnContactarWhatsApp" class="btn-whatsapp" style="margin-right: 10px;">
              üì± Contactar por WhatsApp
            </button>
            <button type="button" id="btnCalificar" class="secondary" style="display: none;">
              ‚≠ê Calificar Servicio
            </button>
            <div class="dialog-nav">
              <button type="button" id="btnAnterior" class="secondary">‚Üê Atr√°s</button>
              <button type="button" id="btnSiguiente" class="secondary">Siguiente ‚Üí</button>
              <button type="button" value="cancel" id="btnCerrarDialog" class="btn-cerrar-footer">Cerrar</button>
            </div>
          </div>
        </div>
      </form>
    </dialog>

    <!-- Modal de Calificaci√≥n -->
    <dialog id="dlgCalificar">
      <form method="dialog" id="frmCalificar">
        <h3>‚≠ê Calificar Servicio</h3>
        <p>¬øC√≥mo fue tu experiencia con este oficio / trabajador?</p>

        <div class="rating-input">
          <span class="star interactive" data-value="1">‚òÜ</span>
          <span class="star interactive" data-value="2">‚òÜ</span>
          <span class="star interactive" data-value="3">‚òÜ</span>
          <span class="star interactive" data-value="4">‚òÜ</span>
          <span class="star interactive" data-value="5">‚òÜ</span>
        </div>
        <input type="hidden" id="ratingValue" value="0" />

        <label>
          Comentario (opcional)
          <textarea id="comentarioCalificacion" placeholder="Cu√©ntanos sobre tu experiencia..." maxlength="500"
            rows="4"></textarea>
        </label>

        <div class="dialog-footer">
          <button type="button" id="btnEnviarCalificacion" class="primary">Enviar Calificaci√≥n</button>
          <button type="button" id="btnCerrarCalificar" class="secondary">Cancelar</button>
        </div>
      </form>
    </dialog>

    <!-- Modal de Registro de Oficio -->
    <dialog id="dlgRegistro">
      <form method="dialog" id="frmRegistro">
        <div class="dialog-header">
          <h3>üöÄ Registro de Oficio</h3>
        </div>

        <div class="dialog-container">
          <p class="form-intro">√önete a nuestro cat√°logo y recibe ofertas de trabajo directamente en tu WhatsApp.</p>

          <div class="form-group" style="display: none;">
            <label for="regNombre">Nombre Completo *</label>
            <input type="text" id="regNombre" required minlength="3" placeholder="Tu nombre y apellidos" readonly>
          </div>

          <div class="form-group">
            <label for="regOficio">Oficio / Profesi√≥n *</label>
            <select id="regOficio" required>
              <option value="">Selecciona un oficio...</option>
              <optgroup label="Construcci√≥n y Mantenimiento">
                <option value="Fontanero">Fontanero</option>
                <option value="Electricista">Electricista</option>
                <option value="Pintor">Pintor</option>
                <option value="Alba√±il">Alba√±il</option>
                <option value="Carpintero">Carpintero</option>
                <option value="Cerrajero">Cerrajero</option>
              </optgroup>
              <optgroup label="Hogar y Limpieza">
                <option value="Limpieza del Hogar">Limpieza del Hogar</option>
                <option value="Jardinero">Jardinero</option>
                <option value="Cuidador/a de Personas Mayores">Cuidador/a de Personas Mayores</option>
                <option value="Cuidador/a de Ni√±os">Cuidador/a de Ni√±os</option>
              </optgroup>
              <optgroup label="Reparaciones">
                <option value="T√©cnico de Electrodom√©sticos">T√©cnico de Electrodom√©sticos</option>
                <option value="T√©cnico de Aire Acondicionado">T√©cnico de Aire Acondicionado</option>
                <option value="Mec√°nico de Autom√≥viles">Mec√°nico de Autom√≥viles</option>
                <option value="Reparaci√≥n de Ordenadores">Reparaci√≥n de Ordenadores</option>
              </optgroup>
              <optgroup label="Servicios Especializados">
                <option value="Profesor Particular">Profesor Particular</option>
                <option value="Dise√±ador Gr√°fico">Dise√±ador Gr√°fico</option>
                <option value="Fot√≥grafo">Fot√≥grafo</option>
                <option value="Traductor">Traductor</option>
              </optgroup>
              <optgroup label="Otros Servicios">
                <option value="Mudanzas">Mudanzas</option>
                <option value="Transporte">Transporte</option>
                <option value="Peluquero/a">Peluquero/a</option>
                <option value="Otros">Otros</option>
              </optgroup>
            </select>
          </div>

          <div class="form-group" id="regOficioOtroContainer" style="display: none;">
            <label for="regOficioOtro">Especifica tu oficio *</label>
            <input type="text" id="regOficioOtro" placeholder="Ej: Masajista, Veterinario...">
            <small>Describe tu oficio o profesi√≥n</small>
          </div>

          <div class="form-group">
            <label for="regUbicacion">Ubicaci√≥n *</label>
            <input type="text" id="regUbicacion" required placeholder="Ciudad o Zona donde trabajas">
          </div>

          <div class="form-group">
            <label for="regWhatsapp">WhatsApp de Contacto *</label>
            <input type="tel" id="regWhatsapp" required pattern="[0-9]{9,15}"
              placeholder="Solo n√∫meros (ej: 612345678)" readonly>
            <small>Los clientes te contactar√°n a este n√∫mero. Se toma de tu cuenta.</small>
          </div>

          <div class="form-group">
            <label for="regModalidad">Modalidad de Trabajo *</label>
            <select id="regModalidad" required>
              <option value="presencial">Presencial</option>
              <option value="remoto">Remoto</option>
              <option value="hibrido">H√≠brido (Ambos)</option>
            </select>
          </div>

          <div class="form-group">
            <label for="regPortafolio">Portafolio (opcional)</label>
            <input type="url" id="regPortafolio" placeholder="Ej: https://miportafolio.com/proyectos">
            <small>Enlace a tu web, LinkedIn, Behance, GitHub o similar. Debe empezar por http:// o https://</small>
          </div>

          <div class="form-group">
            <label for="regHabilidades">Habilidades Principales *</label>
            <input type="text" id="regHabilidades" required
              placeholder="Ej: Reparaciones, Instalaciones, Urgencias 24h">
            <small>Separa las habilidades con comas.</small>
          </div>

          <div class="form-group">
            <label for="regExperiencia">Experiencia / Sobre ti *</label>
            <textarea id="regExperiencia" rows="3" required
              placeholder="Cu√©ntanos brevemente tu experiencia y qu√© servicios ofreces..."></textarea>
          </div>
        </div>

        <div class="dialog-footer">
          <button type="submit" id="btnEnviarRegistro" class="primary">Enviar Solicitud</button>
          <button type="button" id="btnCancelarRegistro" class="secondary">Cancelar</button>
        </div>
      </form>
    </dialog>

    <!-- Di√°logos de Ayuda -->
    <dialog id="dlgHelp" class="help-dialog">
      <div class="help-header">
        <h2>üíº Gu√≠a de Usuario</h2>
        <button type="button" class="help-close" id="btnCerrarHelp">‚úï</button>
      </div>
      <div id="helpContent" class="help-content"></div>
    </dialog>

    <dialog id="dlgLicense" class="help-dialog">
      <div class="help-header">
        <h2>üìÑ T√©rminos de Uso</h2>
        <button type="button" class="help-close" id="btnCerrarLicense">‚úï</button>
      </div>
      <div id="licenseContent" class="help-content"></div>
    </dialog>

    <dialog id="dlgPrivacy" class="help-dialog">
      <div class="help-header">
        <h2>üîí Pol√≠tica de Privacidad</h2>
        <button type="button" class="help-close" id="btnCerrarPrivacy">‚úï</button>
      </div>
      <div id="privacyContent" class="help-content"></div>
    </dialog>

    <footer class="footer">
      <div class="footer-content">
        <p>&copy; 2025 GMR - Empleos en Comunidad - Todos los derechos reservados</p>
        <div class="footer-links">
          <a href="#" id="linkLicense">T√©rminos de Uso</a>
          <span class="separator">|</span>
          <a href="#" id="linkPrivacy">Pol√≠tica de Privacidad</a>
        </div>
      </div>
    </footer>
  </main>

  <!-- Librer√≠a para b√∫squeda difusa (Fuzzy Search) -->
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0/dist/fuse.min.js"></script>
  <!-- Librer√≠a para renderizar Markdown -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="core.pb.js?v=1"></script>
  <script src="usuario.js?v=1"></script>
  <script src="core.ui.js?v=1"></script>
  <script src="app.js?v=4"></script>
</body>

</html>
